#!/bin/sh

case `uname -s` in
	Darwin)
		OS=darwin
		tools/gen_binutils.sh || exit 1
		;;
	Linux)
		OS=linux
		;;
	*)
		echo "Unsupported OS: `uname -s`" >&2
		exit 1
		;;
esac

git submodule update --init

cp config/${OS}.ninja config.ninja

ARCH=`uname -m`

target_dirs='src/boot'

for dir in $target_dirs; do
	if [[ ! -e "$dir"/target ]]; then
		ln -s arch/${ARCH}/ "$dir"/target
	fi
done

